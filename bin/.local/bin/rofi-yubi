#!/bin/bash

set -e

if [ -z "$(ykman list)" ]; then
    rofi -i -p "ğŸ‘£ OTP Manager" -nb \#FF004F -e "ğŸ‘£ No YubiKey detected!"
    exit 1
fi

target=$(ykman oath list | rofi -dmenu -i -no-custom -p "ğŸ‘£ OTP Manager:" -nb \#FF004F)
ykman oath code "$target" | cut -d " " -f3 | xclip -selection "clipboard"
notify-send -t 5000 "OTP in clipboard" "Your $target OTP is currently in your clipboard."
